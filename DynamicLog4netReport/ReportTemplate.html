<!DOCTYPE html>
<html>
<head>
	<title>Html Template</title>
	<meta charset="UTF-8">

	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

	<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
	<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>

	<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.2/react.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/15.6.2/react-dom.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.38/browser.min.js"></script>-->

	<style>
	*
	{
		font-family: Helvetica, Arial, sans-serif;
	}

	label
	{
		color: DimGray;
	}

	a:link
	{
		color: DimGray;
		background-color: transparent;
		text-decoration: none;
	}

	a:visited
	{
		color: DimGray;
	}

	.crossedOut {
		text-decoration: line-through !important;
	}

	/* Styles for statuses (Fail, Pass, Info etc). */
	tr.retry > td.summaryStatus > span, tr.fail > td.summaryStatus > span, tr.pass > td.summaryStatus > span, tr.info > td.summaryStatus > span, tr.warning > td.summaryStatus > span, tr.failskip > td.summaryStatus > span, tr.debug > td.summaryStatus > span,
	tr.retry > td.statusCol > span,     tr.fail > td.statusCol > span,     tr.pass > td.statusCol > span,     tr.info > td.statusCol > span,     tr.warning > td.statusCol > span,     tr.failskip > td.statusCol > span,     tr.debug > td.statusCol > span
	{
		color: White;
		float: left;
		width: 65px;
		padding: 2px 5px;
		margin: 2px;
		-moz-border-radius: 5px;
		border-radius: 5px;
	}

	.statusDebug, .statusdebug { color: gray !important; }
	.statusPass, .statuspass { color: limegreen !important; }
	.statusInfo, .statusinfo { color: lightskyblue !important; }
	.statusFailSkip, .statusfailskip { color: gold !important; }
	.statusWarning, .statuswarning { color: coral !important; }
	.statusRetry, .statusretry { color: GreenYellow !important; }
	.statusFail, .statusfail { color: red !important; }

	tr.debug > td.summaryStatus > span, tr.debug > td.statusCol > span
	{
		background-color: gray;
		text-align: center;
	}

	tr.pass > td.summaryStatus > span, tr.pass > td.statusCol > span
	{
		background-color: limegreen;
		text-align: center;
	}

	tr.retry > td.summaryStatus > span, tr.retry > td.statusCol > span
	{
		background-color: GreenYellow;
		text-align: center;
	}

	tr.fail > td.summaryStatus > span, tr.fail > td.statusCol > span
	{
		background-color: red;
		text-align: center;
	}

	tr.failskip > td.summaryStatus > span, tr.failskip > td.statusCol > span
	{
		background-color: gold;
		text-align: center;
	}

	tr.info > td.summaryStatus > span, tr.info > td.statusCol > span
	{
		background-color: lightskyblue;
		text-align: center;
	}

	tr.warning > td.summaryStatus > span, tr.warning > td.statusCol > span
	{
		background-color: coral;
		text-align: center;
	}

	table.summary
	{
		border-collapse: separate;
		border-spacing: 0px 3px;
		font-size: 12pt;
		width: 100%;
		margin-top: 10px;
	}

	tr.summaryRow
	{
		background-color: #efeeee;
		cursor: pointer;
		padding-top: 10px;
		border-collapse: collapse;
	}
	tr.summaryRow td:first-child { border-top-left-radius:  8px; border-bottom-left-radius:  8px;   border-left: 1px solid gray; }
	tr.summaryRow td:last-child  { border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-right: 1px solid gray;}

		tr.summaryRow > td
		{
			border-top: 1px solid gray;
			border-bottom: 1px solid gray;
			padding: 3px;
			white-space: nowrap;
		}

	.summaryDetailsRow
	{
		display: none;
	}

		.summaryDetailsRow > td
		{
			padding: 0;
		}

		.summaryDetailsRow > td:last-child {
			padding-right: 5px;
		}

	.square
	{
		border: 1px solid limegreen;
		float: left;
		width: 6px;
		height: 6px;
		background-color: limegreen;
		margin: 2px;
		-moz-border-radius: 6px;
		border-radius: 6px;
	}

	.debug .square {
		background-color: gray !important;
		border-color: gray !important;
	}

	.pass .square {
		background-color: limegreen !important;
		border-color: limegreen !important;
	}

	.retry .square {
		background-color: GreenYellow !important;
		border-color: GreenYellow !important;
	}

	.fail .square {
		background-color: red !important;
		border-color: red !important;
	}

	.failskip .square {
		background-color: gold !important;
		border-color: gold !important;
	}

	.info .square {
		background-color: lightskyblue !important;
		border-color: lightskyblue !important;
	}

	.warning .square {
		background-color: coral !important;
		border-color: coral !important;
	}


	table.details
	{
		border-collapse: collapse;
		font-size: 12pt;
		margin-bottom: 20px;
		width: 100%;
	}

		table.details > tbody > tr > td
		{
			border: 1px solid gray;
			padding: 3px;
		}

	tr.detailsHeaderRow
	{
		font-weight: bold;
	}

		tr.detailsHeaderRow > td
		{
			border-top: none !important;
		}

	tr.header > td
	{
		font-family: Helvetica, Arial, sans-serif;
		border-top: none !important;
	}

	td.summaryStatus
	{
		font-weight: bold;
		width: 80px;
	}

	td.summaryTestName
	{
		font-weight: normal;
	}

	td.summaryStart
	{
		width: 70px;
	}

	td.summaryEnd
	{
		width: 70px;
	}

	td.summaryDuration
	{
		width: 140px;
	}

	td.timeCol
	{
		width: 70px;
	}

	td.statusCol
	{
		width: 80px;
	}

	tr.detailsExceptionRow > td > div, .detailsException
	{
		font-family: monospace;
		white-space: pre-wrap;
		max-height: 20em;
		overflow: scroll;
	}

	a.screenshot {
		float: left; margin-right: 5px;
	}

	.pageNavigation {
		color: RGB(0,154,250)
	}

	.exceptionCol {
		font-size: 85%;
	}

	span.screenshotIcon::before {
		content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAASiSURBVHja7FVrTFNnGH6Qci8wgVkZFCql1FIEcZLJRAaMbQzGVSQmm9zqXDbHAJclWzIQyGLCzKTqEmFjYTMaJ8yAIXFIELIlKlCgBbmIxVHYqlAL5SL00Avdd/CwuWQX+MG/fSdPzu19n/f93ttnZbFYsJFrEzZ4bbgBq3VrSPChl49LkfrO3GfQog3bsB/LsIYBaozgKmR4SKSMBJb1GZAgV8B3LxEHcLmZIfkorCvUWxzIZQtQZhP0RiMW1caFZaXlJBpxjmhME5is1kIcJOCUhAp53KTALHg7B6BmUApba0fsF+TAkeUMMykULzYXx24X4kpbPdCCIrKTGqI9wfoX4hh/763ScLFgR0ZoJjyd+Wi8fx49mtvIFH0AxUMFck/l6sblk4+snrHY8WP5vl+lVqNbK4dKq/qIGOgmLAusvyMO4vFKd4v8IhLESdjjlYAG5Tn0adsR73cIfYRYUpGrG77y2yBG0U80xulwDOtG4qUcaSLPmQcVR+VCvgUTKFl/8djLu/S153dHvC5ORKDHC+hQ/4gq+ceI88vC7OISJMTj/h/GVolHCIYIRgnmyFuvXKVI5Al5wBPWZwkcnzwexpmMfbF5aWFxiPbNQM9EK+qGpIjyPQCOoz/K6sqo5u+6htG7su1hgoEVA2GgbPdaHzFMmgehxyLsANW8iqR2hdWabgMWIS/Lik3IixHvgbsNH5eHTiHCOxnhnh4orS2mWi92D1Myk4LxlCYeJFDbHbU+wPa2K47c8RL3ZrtM88isdZphz6CAX4CS5hKKyJgJllkCz235STvjME/No77/It4Ky0bNz9+Yvq68rKLajXLi110iSIeEvqsdjtqkufk6FEUHR3EPBR6BfFKBpi0tW7KDs5Hkm4yc6hwjrqOdyE6uJDlye7jLklmPWlk9JPsy0TZWi7OnL6hwEzeIQBcB7f0Y+327KA7PqVHE9/c5KDoMzcIU8n56B0J3MariqtE60IbUqlQdIe8gHUDr0eHUspYtZiyZF8kOHsPHVYi28VrY27OMFEy0x7fwJnz4QW4VwUJhxNuhx0AZTShr/wQCDzGkkZXoGu1BwReFuunm6dXk0zmSMQUwz1LPjsPLORE+ns641teE5IB3oZJoRP0hGom1q9V7okCuIEOcCzuWE87KP4eBOFS09wTuTdxHpjSL0jZMyxniewwpfafHxQI9Llhdw70yTrpPmK/Hc2jouQQBR4TyVy+gf1dnkD2LDVcbDqoHKvCAGkf+zhLo9UZ8ev44NdSgpKtKwZRrH+P5BMFjJsHMsIvHwaS0qEvlKSdR2VuE3vG7xFs2uGQkzG3SQGfQIWO7BG62W1Fce9w0cFWpJAGgY/wLU1V0KH+lw/E08dPT1BXp+DYj5eWU8je+xJ2pTig07ZgxzJBSjcVmW0+cbpKarn3fojJ3LCtIvSuZqhpkiGexWvn/MK7phvDGKzjhHuKYHhMcbfuiXwTmDHNoGWjFreuyB+Yby52EeDXGNFTMtDSu9TwgPQguwS4C0cqu/vynZwj7mWajiQ2r8349B44NwWYCN8bg6j8jE4YpAmqtxH8Y+P/Q/6/1uwADACSA3UJOwYxSAAAAAElFTkSuQmCC);
	}

	#headerLeft {
		margin-right: 10px;
		float: left;
	}
	#headerLeft > h1 {
		margin-top: 0px;
	}
	#headerRight {
		float: right;
	}
	#headerRight > div {
		width: 400px;
		height: 300px;
		border: 0px solid lightgray;
	}
	.clearBoth {
		clear: both;
	}
	</style>
</head>

<body>
	<div style="width: 1000px;">
		<div id="header">
			<!-- Header of the report -->
			<div id="headerLeft">
				<h1 id="reportTitle">Test Execution Report</h1>
				<h4 id="environmentInfo"><label>Environment:</label> <span id="environment">QA</span></h4>
				<h4 id="testCategory"><label>Category:</label> <span id="category">Smoke</span></h4>
				<h4 id="timeInfo"><label>Start:</label> <span id="startTime">12:18:28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label>End:</label> <span id="endTime">12:20:10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label>Duration:</label> <span id="duration">0h 1m 42s</span></h4>

				<h4 id="passFailInfo"><label class="statusFail">Fail IE:</label> <span class="statusFail" id="IE_statusFail">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="statusFailSkip">FailSkip IE:</label> <span class="statusFailSkip" id="IE_statusFailSkip">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="statusPass">Pass IE:</label> <span class="statusPass" id="IE_statusPass">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="statusRetry">Retry IE:</label> <span class="statusRetry" id="IE_statusRetry">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="statusWarning">Warning IE:</label> <span class="statusWarning" id="IE_statusWarning">1</span></h4>

				[ <span id="stepNames"></span> ]<br/><br/>

				<!-- Expand All / Collapse All link -->
				[ <a id="expandCollapseAll" href="javascript:void(0)">Expand/Collapse All</a> ]
			</div>
			<div id="headerRight">
				<div>
					<canvas id="myCanvas" style="background-color: white;"></canvas>
				</div>
			</div>
			<div class="clearBoth"></div>
		</div>
		<div id="content">
		</div>
	</div>
	<script type="text/babel">
		var reportData = [
			{"EndOfReportData":true} // logger will add data into reportData array during tests execution
		];


		reportData.splice(-1,1)

		for (var i = 0; i < reportData.length; i++) {
			reportData[i].TimeStampUtc = new Date(reportData[i].TimeStampUtc);
		}

		//////////////////////////////////////////////////////////////////////////
		var groupBy = function(list, key) {
			return list.reduce(function(rv, x) {
				(rv[x[key]] = rv[x[key]] || []).push(x);
				return rv;
			}, {});
		};

		var reportDataGroups = [];
		var groupsObject = groupBy(reportData, 'FullTestCaseName');

		Object.keys(groupsObject).forEach(function(key,index) {
			var reportDataGroup = groupsObject[key];
			reportDataGroup.FullTestCaseName = reportDataGroup[0].FullTestCaseName;
			reportDataGroup.GetLevel = function() {
				return reportDataGroup
					.reduce((accumulator, currentValue) => currentValue.LevelValue > accumulator.LevelValue ? currentValue : accumulator, reportDataGroup[0])
					.Level;
			};
			reportDataGroup.GetStartTime = function() {
				return reportDataGroup
					.reduce((accumulator, currentValue) => currentValue.TimeStampUtc < accumulator.TimeStampUtc ? currentValue : accumulator, reportDataGroup[0])
					.TimeStampUtc;
			};
			reportDataGroup.GetEndTime = function() {
				return reportDataGroup
					.reduce((accumulator, currentValue) => currentValue.TimeStampUtc > accumulator.TimeStampUtc ? currentValue : accumulator, reportDataGroup[0])
					.TimeStampUtc;
			};
			reportDataGroups.push(reportDataGroup);
		});
		//////////////////////////////////////////////////////////////////////////

		var timeOnlyFormatter = new Intl.DateTimeFormat('en-US', {hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: false});

		class SummaryRow extends React.Component {
			constructor(props) {
				super(props);
			}
			render() {
				var level = this.props.reportDataGroup.GetLevel();
				return (
					<tr className={`summaryRow ${level.toLowerCase()}`}>
						<td className='summaryStatus'><span>{level}</span></td>
						<td className='summaryTestName'>{this.props.reportDataGroup.FullTestCaseName}</td>
						<td className='summaryStart'>{timeOnlyFormatter.format(this.props.reportDataGroup.GetStartTime())}&nbsp;&nbsp;- </td>
						<td className='summaryEnd'>{timeOnlyFormatter.format(this.props.reportDataGroup.GetEndTime())}</td>
						<td className='summaryDuration' title='Duration: TODO!!!'><div style={{width: '52px'}}></div><span className='square'></span><span className='square'></span><span className='square'></span><span className='square'></span></td>
					</tr>
				)
			}
		}

		class SummaryTable extends React.Component {
			constructor(props) {
				super(props);
			}
			render() {
				return (
					<table className='summary'>
						<tbody>
							{this.props.reportDataGroups.map((reportDataGroup, i) => {
								return (
									<SummaryRow key={reportDataGroup.FullTestCaseName} reportDataGroup={reportDataGroup}/>
								);
							})}
						</tbody>
					</table>
				)
			}
		}

		ReactDOM.render(
			<SummaryTable reportDataGroups={reportDataGroups}/>,
			document.getElementById('content')
		);
	</script>
</body>
</html>